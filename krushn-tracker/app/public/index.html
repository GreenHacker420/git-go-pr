<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Krushn's Hacktoberfest Tracker</title>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
      table,
      th,
      td {
        border: 1px solid black;
        border-collapse: collapse;
        padding: 8px;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <h1>Krushn's Hacktoberfest Tracker</h1>

      <table v-if="statistics">
        <tr>
          <td>Total PRs</td>
          <td>{{ statistics.totalPRs }}</td>
        </tr>
        <tr>
          <td>Merged PRs</td>
          <td>{{ statistics.mergedPRs }}</td>
        </tr>
        <tr>
          <td>Open PRs</td>
          <td>{{ statistics.openPRs }}</td>
        </tr>
        <tr>
          <td>Closed PRs</td>
          <td>{{ statistics.closedPRs }}</td>
        </tr>
        <tr>
          <td>Total Repositories</td>
          <td>{{ statistics.totalRepositories }}</td>
        </tr>
        <tr>
          <td>Red-Flagged Repositories</td>
          <td>{{ statistics.redFlaggedRepositories }}</td>
        </tr>
        <tr>
          <td>Total Users</td>
          <td>{{ statistics.totalUsers }}</td>
        </tr>
        <tr>
          <td>Total Colleges</td>
          <td>{{ statistics.totalColleges }}</td>
        </tr>
        <tr>
          <td>Total Owners</td>
          <td>{{ statistics.totalOwners }}</td>
        </tr>
      </table>

      <h2>Pull Requests</h2>
      <table v-if="prs.length">
        <thead>
          <tr>
            <td v-if="statistics" colspan="6">
              Visible PRs: {{ prs.length }} | Hidden PRs: {{ statistics.totalPRs
              - prs.length }}
            </td>
          </tr>
          <tr>
            <th>Author</th>
            <th>Owner</th>
            <th>Repository</th>
            <th>Status</th>
            <th>Title</th>
            <th>Link</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="pr in prs" :key="pr._id">
            <td>
              <p>{{ pr.author.full_name }}</p>
              <p>{{ pr.author.username }}</p>
              <p>
                {{ pr.author.college?.name }} - {{ pr.author.college?.year }}
              </p>
              <p>{{ pr.author.role }}</p>
            </td>

            <td>{{ pr.repository.owner.username }}</td>

            <td>
              {{ pr.repository.name }}

              Is Self Repo? {{pr.repository.owner.username === pr.author.username ? 'Yes' : 'No'}}

              <button @click="redFlagRepository(pr.repository._id)">
                Mark Red Flag
              </button>
            </td>

            <td>
              <span v-if="pr.is_merged">Merged</span>
              <span v-else-if="pr.is_open">Open</span>
              <span v-else>Closed</span>
            </td>

            <td>{{ pr.title }}</td>

            <td><a :href="pr.link" target="_blank">View PR</a></td>
          </tr>
        </tbody>
      </table>
    </div>

    <script src="/main.js"></script>

    <script>
      /**
      const statistics = {
        totalPRs,
        mergedPRs,
        openPRs,
        closedPRs,
        totalRepositories,
        redFlaggedRepositories,
        totalUsers,
        totalColleges,
        totalOwners,
      }
      */

      /** 
      const PR = {
        _id: '68e985090744826b0baffecb',
        github_id: 3498445179,
        title: 'Humra namm Utsav h',
        body: null,
        author: {
          _id: '68e9800352e4adee99aebad8',
          username: 'UtsavDoye20122005',
          github_id: 71711535,
          full_name: 'UTSAV DOYE',
          college: {
            _id: '68e9800352e4adee99aebad5',
            name: 'NST SVYASA',
            __v: 0,
            createdAt: '2025-10-10T21:52:03.676Z',
            updatedAt: '2025-10-10T21:52:03.676Z',
          },
          year: '1st Year',
          role: 'student',
          createdAt: '2025-10-10T21:52:03.694Z',
          updatedAt: '2025-10-10T21:52:03.694Z',
          __v: 0,
        },
        repository: {
          _id: '68e985090744826b0baffec8',
          github_id: 1072838275,
          name: 'fork-pr-activity',
          owner: {
            _id: '68e985080744826b0baffec5',
            github_id: 235483496,
            name: null,
            username: 'adarsh-inst',
            type: 'User',
            createdAt: '2025-10-10T22:13:28.851Z',
            updatedAt: '2025-10-10T22:13:28.851Z',
            __v: 0,
          },
          is_gosc: false,
          is_redFlagged: false,
          createdAt: '2025-10-10T22:13:29.357Z',
          updatedAt: '2025-10-10T22:13:29.357Z',
          __v: 0,
        },
        is_open: false,
        is_merged: true,
        is_redFlagged: false,
        redFlag_reason: '',
        redFlag_by: null,
        redFlag_at: null,
        createdAt: '2025-10-09T09:52:39.000Z',
        updatedAt: '2025-10-10T22:36:04.092Z',
        __v: 0,
        link: 'https://github.com/adarsh-inst/fork-pr-activity/pull/40',
      }
      */
    </script>
  </body>
</html>
